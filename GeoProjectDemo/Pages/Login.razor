@page "/"
@inject NavigationManager navigationManager
@inject AuthenticationStateProvider authStateProvider
@inject Blazored.SessionStorage.ISessionStorageService sessionStorage
@using GeoProjectDemo.Globals
@using System.Security.Principal;

<h1>Login</h1>

<AuthorizeView>
    <Authorized>
        <p>Welcome, @context.User.Identity.Name</p>
    </Authorized>
    <NotAuthorized>
        <p>not authorized</p>
    </NotAuthorized>
</AuthorizeView>

<TelerikTextBox @bind-Value="FelhasznaloNev" Label="Felhasználó">
</TelerikTextBox>

<TelerikTextBox @bind-Value="Jelszo" Label="Jelszó">
</TelerikTextBox>

<TelerikButton @onclick="Bejelentkezes">Bejelentkezés</TelerikButton>

Welcome to your new app.

@code {

    public string FelhasznaloNev { get; set; }

    public string Jelszo { get; set; }


    public void Bejelentkezes( )
    {
        (authStateProvider as CustomAuthStateProvider).LogInUser( "mate" );
        navigationManager.NavigateTo( "menu" );

        sessionStorage.SetItemAsync( "username", "mate" );

        //var a = System.Environment.MachineName;
        //var b = WindowsIdentity.GetCurrent( ).Name;

        //string name = "mbrunner";
        //string domain = "GEO";
        //string password = "asdf";

        //IntPtr tokenHandle = IntPtr.Zero;

        //var isSuccess = WindowsAuthentication.LogonUser( name, domain, password, 2, 0, ref tokenHandle );

        //if ( isSuccess )
        //{
        //    winAuth.LoginUser( new User( ) { Nev = name } );
        //    navigationManager.NavigateTo( "menu" );
        //}


    }



}